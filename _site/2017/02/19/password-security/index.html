<!DOCTYPE html>
<html lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#">

  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta property="og:image" content="/public/photo.jpg" />

    <title>
        
        用什麼樣的密碼比較安全呢 &middot; jyt0532's Blog
        
    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/poole.css">
    <link rel="stylesheet" href="/public/css/syntax.css">
    <link rel="stylesheet" href="/public/css/hyde.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/public/favicon.ico">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-89295041-1', 'auto');
        ga('send', 'pageview');
    </script>
</head>


  <body class="theme-base-0f">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          jyt0532's Blog
        </a>
      </h1>
      <p class="lead">learning never ends</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/tag_cloud/">Tag Cloud</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <!--      <a class="sidebar-nav-item" href="https://github.com/jyt0532/archive/v2.1.0.zip">Download</a> -->
      <a class="sidebar-nav-item" href="https://github.com/jyt0532">GitHub project</a>
      <span class="sidebar-nav-item">Currently v2.1.0</span>
    </nav>

    <p>&copy; 2017. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">用什麼樣的密碼比較安全呢</h1>
  <span class="post-date">19 Feb 2017</span>
  <p>今天來講一下各大網站保存密碼的方式 
如果你是engineer的話而且知道hash+salt是什麼意思可以直接跳過這篇文章
如果非CS的只是來湊湊熱鬧 那可以直接往下拉到結論 
我告訴你你的密碼安不安全</p>

<h3 id="hash-your-password">Hash your password</h3>

<p>如果你在做一個網站後端開發 一個使用者創帳號的時候 
你要用一個固定的hash function在database裏存hash過後的密碼
每次使用者登入的時候 
把使用者給你的密碼hash之後
看看跟你database的那個一不一樣 因為hash是不能reverse的 
所以即使哪天資料外洩 hacker也無法知道你的明碼</p>

<p>HASH(plain_text) == saved_string</p>

<h3 id="聽起來挺ok的啊">聽起來挺ok的啊</h3>

<p>一開始的確是沒什麼問題 所以一開始網站沒有給太多密碼複雜度的限制
但隨著記憶體空間越來越便宜 <strong>hacker可以先把所有可能的hash結果存起來</strong>
再一一比對他從database拿到的hashed_value跟他先算好的表有沒有match 
match到你的密碼就被破解</p>

<p>光說不練假把戲 來點數學吧 
十年前安全性沒人要求的時候 一般人的密碼都挺短的而且都是英文+數字 
假設長度是7的話
那所有的可能明碼也才(26+10)^7種 假設現在是用md5 hash(hash完的長度是128bits)</p>

<p>(1*7 + 128 / 8)*(26+10)^7 bytes = 1.8TB</p>

<p>意思是我存下所有的mapping 1*7是明碼 128/8是hash過的密碼byte大小</p>

<p>在2017年這個容量簡直輕鬆愉快啊 那麼該怎麼辦呢</p>

<h3 id="salt">Salt</h3>

<p>這個時候就需要加點隨機的東西增加亂度了 解法就是在每個人創帳號密碼的時候 隨機生成一個字串 加在明碼後面或是穿插明碼其中
Verify的時候也一樣 只要server記得每個人的隨機字串就可以</p>

<p>HASH(plain_text + salt) == saved_string</p>

<p><strong>最好連salt的長度也是random</strong>(當然要越長越好) 這樣的話hacker就必須所有的長度都有個表
那其實更快的方式是直接把username或是email加進來hash
基本上就是增加原本字串的難度 畢竟所有md5的output是2^128 沒有一個machine可以記得了所有的input
而增加難度最簡單的方式 就是增加長度 長度每加一 難度變36倍</p>

<p>另一種就是增加可能的字母 加上大寫(26)加上特殊符號(32)(<a href="https://www.owasp.org/index.php/Password_special_characters">Password special character</a>)底數直接從36 -&gt; 94 那自然就更難了</p>

<p>所以為什麼大網站都會要求你用長度最少12 最少要有一個大寫 一個小寫 一個特殊字母 一個數字
這樣如果hacker萬一哪天破解了這個網站的database拿到了hash過的密碼 大概未來一兩年內都還不會有事
但如果再加上random長度的salt 基本上就不太可能用這種暴力法破解</p>

<h3 id="問題">問題</h3>

<p>Q:既然salt是存在database的明碼 那遲早有一天記憶體大到可以cover長度10的密碼 
那再把它減去salt不就得到user的密碼了嗎</p>

<p>A:所以salt有兩個目的 第一個是讓hash前的字串總長度拉長 這樣即使使用者給的長度不夠 還是可以增加暴力破解難度</p>

<p>舉個例子 如果user密碼長度是10 salt長度是5 那總長度是15的密碼就不太可能用建表暴力解再減salt的方式</p>

<p>Q:總長度15的不好建 10的總可以了吧 他不就可以把所有排列組合+salt建表嗎</p>

<p>A:答對了！這就是為什麼salt要random</p>

<p>salt的第二個目的是可以把損失降到最低 那個hacker一次還是只能破解一個人的密碼
因為他必須對每個新的salt 重新建表 這樣可以幫security部門爭取時間叫人家改密碼</p>

<h3 id="如果我是hacker">如果我是hacker</h3>

<p>當然不是說什麼順便hack生日這種資訊 排列組合猜一猜 這是要猜到什麼時候 
這個blog怎麼可能講出這麼沒格調的話
基本概念很簡單 因為大家懶 十年前大家需要辦帳號時都有過密碼 而當時對於密碼的要求不高
所以很有可能大多數的密碼都只有小寫英文(因為大腦不喜歡英文單字中參雜數字這種不協調感)
然後呢 之後安全意識抬頭 大家要求要有大寫字母和特殊字元 可是大家又不想改原本的密碼太多
所以就很簡單的加在原本的密碼後面
考慮這些歷史因素的話
我就會先創建所有的可能密碼的hash 大概長這樣</p>

<p>abcdefgH0!(前七～九個是小寫英文 後面一個大寫英文 後面一個數字 後面一個特殊符號)</p>

<p>我相信這樣應該會中一些XD 但如果網站有加salt那就什麼都不管用了
這就是為什麼你身為develoer要加salt的原因 就像短版效應一樣</p>

<p><em>你密碼的安全度取決於所有你用同一個密碼的網站裡 security做最差的網站的安全度</em></p>

<h3 id="講這麼多-所以我的密碼到底夠不夠強呢">講這麼多 所以我的密碼到底夠不夠強呢</h3>

<p>大概念就是越長越好 這是最重要的因素 
其中穿插大小寫互換跟數字 然後特殊符號穿插其中(不要擺最前也不要擺最後)
雖然很麻煩 但打一下就習慣</p>

<p>所以你的密碼到底有多安全呢 長度10都是英文小寫跟長度8但可以有特殊符號 哪個比較安全呢</p>

<p>簡單的計算方式就是</p>

<p>(1*n + 128 / 8)*(26 or 36 or 62 or 94)^n</p>

<p>n是密碼長度</p>

<p>26就是只有小寫英文</p>

<p>36就是只有小寫英文+數字</p>

<p>62就是只有大小寫英文+數字</p>

<p>94就是只有大小寫英文+數字+特殊符號</p>

<p>我的經驗法則是如果你的數字小於10^24 那大概就跟jon snow一樣</p>

<p><img src="http://localhost:4000/public/hugearmy.gif" alt="Alt text" /></p>

<p>建議你換個密碼囉!</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2017/03/06/https/">
            網路安全(2) - HTTPS
            <small>06 Mar 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2017/02/25/simple-cryptography/">
            網路安全(1) - 基礎密碼學
            <small>25 Feb 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2017/02/22/password-security-en/">
            Is your password secure?
            <small>22 Feb 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      
<div id="disqus_thread"></div>
<script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    
    var disqus_config = function () {
        this.page.url = 'https://jyt0532.github.io/2017/02/19/password-security/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2017/02/19/password-security'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//https-jyt0532-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </div>
  </body>
</html>
